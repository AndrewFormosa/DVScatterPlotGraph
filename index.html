<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Visualisation Project _ Scatter Plot Graph</title>
    <link rel="stylesheet" href="./stylesheet.css" />
</head>

<body>

    <h1>Scatter Plot Graphs</h1>

    <script src="https://cdn.freecodecamp.org/testable-projects-fcc/v1/bundle.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script>

        const w = window.innerWidth - 50;
        const h = window.innerHeight - 200;
        const padding = 60;

        const svg = d3.select("body")
            .append("div")
            .attr("class", "scatter-graph")
            .append("svg")
            .attr("width", w)
            .attr("height", h)
            .attr("style", "background:white");

        fetch("https://raw.githubusercontent.com/freeCodeCamp/ProjectReferenceData/master/cyclist-data.json")
            .then(response => response.json())
            .then(data => {
                dataString = JSON.stringify(data);
                let years =data.map((x)=>x.Year);
                let time =data.map((x)=>x.Time);

           //set xScale

           let parseYear = d3.timeParse("%Y"); //ensure that data.year is formated as a year for d3
          const xScale = d3.scaleTime()
                    .domain([d3.min(data,(d)=> parseYear(d.Year)),d3.max(data,(d)=>parseYear(d.Year))])
                   .range([padding, w-padding]);

                let parseTime=d3.timeParse("%M:%S");
                    const yScale = d3.scaleTime()
                    .domain([d3.min(data,(d)=>parseTime(d.Time)),d3.max(data,(d)=>parseTime(d.Time))])
                    .range([h - padding,padding]);


            

                //.append("text")
                //    .attr("x", "5")
                //    .attr("y", "5")
                //    .text(data.map((x) => x.Year));
const xAxis = d3.axisBottom(xScale);
                svg.append("g")
                .attr("id", "x-axis")
                .attr("transform","translate(0,"+(h-padding)+")")
               .call(xAxis);

               const yAxis = d3.axisLeft(yScale);

                svg.append("g")
                .attr("id", "y-axis")
                .attr("transform","translate("+padding+","+0+")")
               .call(yAxis);

                d3.select("body")
                    .append("text")
                    .attr("x", "5")
                    .attr("y", "5")
                    .text(data.map((x) => x.Year));
                  
                d3.select("body")
                    .append("text")
                    .attr("x", "5")
                    .attr("y", "5")
                    .text(data.map((x) => x.Time + " - p - "+(parseTime(x.Time))));

                d3.select("body")
                    .append("text")
                    .attr("x", "5")
                    .attr("y", "5")
                    .text(dataString);

            });


    </script>





</body>

</html>